<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pprof">
<title>Getting Started with pprof • pprof</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.8/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.8/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.8/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with pprof">
<meta property="og:description" content="pprof">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pprof</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/pprof.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-appendix">Appendix</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-appendix">
    <a class="dropdown-item" href="../articles/Logis-FE.html">Logis FE</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/UM-KevinHe/pprof/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting Started with pprof</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/UM-KevinHe/pprof/blob/HEAD/vignettes/pprof.Rmd" class="external-link"><code>vignettes/pprof.Rmd</code></a></small>
      <div class="d-none name"><code>pprof.Rmd</code></div>
    </div>

    
    
<style>
body {
  text-align: justify
}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>pprof</code> software package is designed to provide
different risk-adjusted models for data with various types of outcomes,
specifically focusing on the field of provider profiling. In addition to
model fitting, the package equips a suite of functions for calculating
standardized ratios and rates, conducting statistical inference, and
generating various plots to aid in the interpretation of results.
Currently, the package supports logistic fixed effect models for binary
outcomes, as well as linear fixed effect and linear random effect models
for continuous outcomes. It is under ongoing development, with plans to
incorporate additional models and more robust testing methods.</p>
<p>This tutorial provides a brief overview of the package’s structure
and a detailed guide of how to utilize the various functions. Simulated
example data (<code>ExampleDataBinary</code>) with binary outcomes will
be used as an illustration, alongside a real data set with continuous
outcomes (<code>ecls_data</code>) to demonstrate its application with
continuous outcomes. Throughout the tutorial, we will cover the key
features and capabilities of <code>pprof</code>, presenting examples and
use cases to illustrate its functionality comprehensively.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org" class="external-link">"remotes"</a></span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"UM-KevinHe/pprof"</span>, ref <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="package-workflow-overview">Package Workflow Overview<a class="anchor" aria-label="anchor" href="#package-workflow-overview"></a>
</h2>
<p>This section presents the structure and workflow of the
<code>pprof</code> package. Generally, for datasets with continuous
outcomes, either a fixed effect model or a random effect model can be
fitted, while for binary outcomes, the current version only supports the
fixed effect model. For the calculation of standardized measures, both
indirect and direct standardization methods are provided for all models.
Regarding hypothesis testing of provider effects, <code>pprof</code>
includes the flagging based on each provider’s performance, categorizing
them as 1 (statistically higher), 0 (as expected), or -1 (statistically
lower). Confidence intervals are provided for both provider effects and
standardized measures. Additionally, various visualizations are equipped
to facilitate interpretation of the results. These include caterpillar
plots for the confidence intervals of standardized measures, bar plots
showing flagging percentages overall and stratified by provider sizes,
and funnel plots for indirect standardized measures in fixed effect
models. These visualizations offer multiple perspectives for
understanding the results effectively.</p>
<p><img src="Charts/pprof%20flowchart.png" width="3000"></p>
</div>
<div class="section level2">
<h2 id="model-fitting">Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<p><code>pprof</code> package introduces three different fitting
functions: <code>logis_fe</code> for logistic fixed effect model,
<code>linear_fe</code> for linear fixed effect model, and
<code>linear_re</code> for linear random effect mode.</p>
<p>The simulated dataset <code>ExampleDataBinary</code> is used as an
example in this section.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UM-KevinHe/pprof" class="external-link">pprof</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleDataBinary</span><span class="op">)</span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="va">ExampleDataBinary</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">covar</span> <span class="op">&lt;-</span> <span class="va">ExampleDataBinary</span><span class="op">$</span><span class="va">Z</span></span>
<span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="va">ExampleDataBinary</span><span class="op">$</span><span class="va">ID</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">outcome</span>, <span class="va">covar</span>, <span class="va">ID</span><span class="op">)</span></span></code></pre></div>
<p>Each model function supports three different ways to input data.
Users have the flexibility to choose the one that best suits their data
availability and convenience. Firstly, users can provide a formula and
the whole dataset.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula_fe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"outcome ~ id(ID) + z1 + z2 + z3 + z4 + z5"</span><span class="op">)</span></span>
<span><span class="va">fit_fe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logis_fe.html">logis_fe</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula_fe</span>, data <span class="op">=</span> <span class="va">data</span>, message <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>Additionally, users also input the whole dataset, along with the
column names of the outcome vector, the covariate matrix/data frame, and
the provider identifier vector.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "outcome" "z1"      "z2"      "z3"      "z4"      "z5"      "ID"</span></span>
<span><span class="va">Y.char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">Z.char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">ID.char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span></span>
<span><span class="va">fit_fe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logis_fe.html">logis_fe</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, Y.char <span class="op">=</span> <span class="va">Y.char</span>, Z.char <span class="op">=</span> <span class="va">Z.char</span>, ID.char <span class="op">=</span> <span class="va">ID.char</span>, message <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>Finally, the function also accepts the outcome vector, the covariate
matrix/data frame, and the provider identifier vector.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_fe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logis_fe.html">logis_fe</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">outcome</span>, Z <span class="op">=</span> <span class="va">covar</span>, ID <span class="op">=</span> <span class="va">ID</span>, message <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>By default, each model fitting function automatically removes all
observations containing missing values. If users encounter data-related
issues, they can utilize our built-in function <code>data_check</code>
to perform data quality checks. This function can assist in examining
missingness, variation, correlation, and the variance inflation factor
(VIF) of variables to ensure data quality before fitting a model.</p>
<p>The logistic fixed effect model provides two algorithmic approaches:
the Serial Blockwise Inversion Newton (SerBIN) algorithm (See <a href="https://um-kevinhe.github.io/ppsrr/articles/Logis-FE.html" class="external-link">Logis
FE</a> for more details) and the Block Ascent Newton algorithm. The
preferred method can be specified by setting the <code>method</code>
argument, allowing users to choose the algorithm that best fits their
computational needs and model requirements.</p>
</div>
<div class="section level2">
<h2 id="standardized-measures">Standardized Measures<a class="anchor" aria-label="anchor" href="#standardized-measures"></a>
</h2>
<p>Based on the results obtained from the fitted model, users can easily
calculate direct or indirect standardized measures as per their specific
requirements. The <code>SM_output</code> function simply necessitates
the users to input the object returned from the model functions and
specify the desired type of measure. Additionally, the observed outcomes
and “expected” outcomes are included in case users wish to calculate
standardized measures under different definitions.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SM_output.html">SM_output</a></span><span class="op">(</span><span class="va">fit_fe</span>, stdz <span class="op">=</span> <span class="st">"indirect"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SR</span><span class="op">$</span><span class="va">indirect.ratio</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Indirect_standardized.ratio</span></span>
<span><span class="co">#&gt; 1                   0.9025369</span></span>
<span><span class="co">#&gt; 2                   1.1081224</span></span>
<span><span class="co">#&gt; 3                   0.8994107</span></span>
<span><span class="co">#&gt; 4                   1.0742682</span></span>
<span><span class="co">#&gt; 5                   0.9771412</span></span>
<span><span class="co">#&gt; 6                   1.0311867</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SR</span><span class="op">$</span><span class="va">indirect.rate</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Indirect_standardized.rate</span></span>
<span><span class="co">#&gt; 1                   34.99262</span></span>
<span><span class="co">#&gt; 2                   42.96346</span></span>
<span><span class="co">#&gt; 3                   34.87141</span></span>
<span><span class="co">#&gt; 4                   41.65088</span></span>
<span><span class="co">#&gt; 5                   37.88513</span></span>
<span><span class="co">#&gt; 6                   39.98055</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SR</span><span class="op">$</span><span class="va">OE</span><span class="op">$</span><span class="va">OE_indirect</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Obs_provider Exp.indirect_provider Var.indirect_provider</span></span>
<span><span class="co">#&gt; 1           31              34.34763              8.009189</span></span>
<span><span class="co">#&gt; 2           16              14.43884              6.107131</span></span>
<span><span class="co">#&gt; 3           35              38.91437             11.132482</span></span>
<span><span class="co">#&gt; 4           39              36.30378             10.725251</span></span>
<span><span class="co">#&gt; 5           23              23.53805              8.296404</span></span>
<span><span class="co">#&gt; 6           34              32.97172              9.162980</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="hypothesis-testing-for-provider-effects">Hypothesis Testing for Provider Effects<a class="anchor" aria-label="anchor" href="#hypothesis-testing-for-provider-effects"></a>
</h2>
<p>The <code>test</code> function is designed to conduct hypothesis
testing for provider effects and identify outlier providers. It returns
a four-column dataframe, where the “flag” column indicates whether a
provider is flagged as an outlier. The other three columns provide the
p-values, corresponding test statistics, and the standard errors of
provider effects. Users have the flexibility to choose between two-sided
and one-sided tests by specifying the <code>alternative</code> argument.
In cases when the number of providers is very large, outputting all
results at once may become cumbersome. To address this, users can opt to
display results only for the providers of particular interest by setting
the <code>parm</code> argument to the corresponding provider ID. This
selective output feature makes it easier for users to focus on specific
providers without being overwhelmed by extensive data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/test.html">test</a></span><span class="op">(</span><span class="va">fit_fe</span>, parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">61</span><span class="op">:</span><span class="fl">65</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    flag      p value        stat</span></span>
<span><span class="co">#&gt; 16   -1 0.0299553164 -2.17068071</span></span>
<span><span class="co">#&gt; 17    0 0.0745112915  1.78346100</span></span>
<span><span class="co">#&gt; 18   -1 0.0361175315 -2.09560178</span></span>
<span><span class="co">#&gt; 19    0 0.5606615895  0.58185910</span></span>
<span><span class="co">#&gt; 20    0 0.9903105282  0.01214425</span></span>
<span><span class="co">#&gt; 61    1 0.0004267554  3.52296022</span></span>
<span><span class="co">#&gt; 62    0 0.0677680598  1.82654599</span></span>
<span><span class="co">#&gt; 63    0 0.3526406608  0.92947947</span></span>
<span><span class="co">#&gt; 64    0 0.3894835561  0.86055432</span></span>
<span><span class="co">#&gt; 65    0 0.1026006595 -1.63237430</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="hypothesis-testing-for-covariate-coefficients">Hypothesis Testing for Covariate Coefficients<a class="anchor" aria-label="anchor" href="#hypothesis-testing-for-covariate-coefficients"></a>
</h2>
<p>Additionally, we offer the <code>summary</code> function to provides
the test statistics for the covariate coefficients. The output dataframe
may include the estimates, standard errors, p-values, and confindence
intervals.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_fe</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Estimate  Std.Error     Stat p value  CI.Lower CI.Upper</span></span>
<span><span class="co">#&gt; z1 1.0512744 0.04179173 25.15508       0 0.9693641 1.133185</span></span>
<span><span class="co">#&gt; z2 1.0229572 0.04093213 24.99154       0 0.9427316 1.103183</span></span>
<span><span class="co">#&gt; z3 0.9918962 0.04035333 24.58028       0 0.9128051 1.070987</span></span>
<span><span class="co">#&gt; z4 1.0413031 0.04115101 25.30443       0 0.9606486 1.121958</span></span>
<span><span class="co">#&gt; z5 1.0930890 0.04173967 26.18825       0 1.0112808 1.174897</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="confidence-interval">Confidence Interval<a class="anchor" aria-label="anchor" href="#confidence-interval"></a>
</h2>
<p>Both the confidence intervals for provider effects and standardized
measures can be obtained from the function <code>confint</code> by
specifying the value of argument <code>option</code>. The function will
return a three-column data frame that provides the estimates, along with
the corresponding upper and lower bounds of the confidence
intervals.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_fe</span>, parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">55</span><span class="op">:</span><span class="fl">60</span><span class="op">)</span>, option <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         gamma gamma.lower  gamma.upper</span></span>
<span><span class="co">#&gt; 55 -1.4176768   -2.057409 -0.792812684</span></span>
<span><span class="co">#&gt; 56 -0.6624298   -1.239835 -0.091294432</span></span>
<span><span class="co">#&gt; 57 -0.6411525   -1.295789 -0.006435919</span></span>
<span><span class="co">#&gt; 58 -1.3264628   -1.966684 -0.699596625</span></span>
<span><span class="co">#&gt; 59 -0.8219975   -1.473821 -0.178134425</span></span>
<span><span class="co">#&gt; 60 -1.1748531   -1.834632 -0.526685839</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_fe</span>, parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span><span class="op">:</span><span class="fl">85</span><span class="op">)</span>, option <span class="op">=</span> <span class="st">"SM"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $CI.indirect_ratio</span></span>
<span><span class="co">#&gt;    indirect_ratio CI_ratio.lower CI_ratio.upper</span></span>
<span><span class="co">#&gt; 80      0.6651076      0.4614515      0.8967515</span></span>
<span><span class="co">#&gt; 81      0.0000000      0.0000000      1.1422604</span></span>
<span><span class="co">#&gt; 82      1.0857752      0.8814482      1.3007155</span></span>
<span><span class="co">#&gt; 83      1.0965577      0.9548462      1.2299472</span></span>
<span><span class="co">#&gt; 84      1.1255589      0.9578273      1.2922141</span></span>
<span><span class="co">#&gt; 85      1.1540167      0.9741097      1.3352526</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CI.indirect_rate</span></span>
<span><span class="co">#&gt;    indirect_rate CI_rate.lower CI_rate.upper</span></span>
<span><span class="co">#&gt; 80      25.78715      17.89112      34.76831</span></span>
<span><span class="co">#&gt; 81       0.00000       0.00000      44.28703</span></span>
<span><span class="co">#&gt; 82      42.09702      34.17498      50.43056</span></span>
<span><span class="co">#&gt; 83      42.51508      37.02073      47.68678</span></span>
<span><span class="co">#&gt; 84      43.63949      37.13631      50.10095</span></span>
<span><span class="co">#&gt; 85      44.74284      37.76760      51.76961</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<p>The caterpillar plot is a type of visualization used to display
confidence intervals for estimated parameters, often employed to
identify outliers or assess the variability across groups or providers.
In <code>pprof</code>, the <code>caterpillar_plot</code> function is
used to generate such plots, providing a clear representation of
standardized measures and their associated confidence intervals. To use
this function, users need to input a dataframe returned by our built-in
<code>confint</code> function, with the <code>option</code> argument set
to “SM” to ensure standardized measures are visualized.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CI_SM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_fe</span>, option <span class="op">=</span> <span class="st">"SM"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/caterpillar_plot.html">caterpillar_plot</a></span><span class="op">(</span><span class="va">CI_SM</span><span class="op">$</span><span class="va">CI.indirect_ratio</span>, use_flag <span class="op">=</span> <span class="cn">T</span>, errorbar_width <span class="op">=</span> <span class="fl">0.5</span>, errorbar_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="pprof_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Additionally, a bar plot is also provided to visualize the overall
flagging percentage, as well as the percentages stratified by provider
sizes. The providers are divided into a specified number of groups, set
by the <code>group_num</code> argument, where the number of providers is
approximately equal across all groups. The flagging percentage for each
group is then displayed, giving insights into variations in provider
performance. For this plot, users need to input the dataframe returned
from the <code>test</code> function. This visualization offers an
effective way to interpret the performance distribution across different
provider groups.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/test.html">test</a></span><span class="op">(</span><span class="va">fit_fe</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span><span class="va">test_df</span>, group_num <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="pprof_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>The current version of <code>pprof</code> also supports the funnel
plot through the <code>plot</code> function, an effective graphical tool
for identifying healthcare providers with unusual performance. This
function can visualize the indirect standardized differences for the
linear fixed effect model and the indirect standardized ratios for the
logistic fixed effect model, offering valuable insights into variations
in provider performance.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_fe</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="pprof_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="real-data-example">Real Data Example<a class="anchor" aria-label="anchor" href="#real-data-example"></a>
</h2>
<div class="section level3">
<h3 id="early-childhood-longitudinal-study-ecls-dataset">Early Childhood Longitudinal Study (ECLS) Dataset<a class="anchor" aria-label="anchor" href="#early-childhood-longitudinal-study-ecls-dataset"></a>
</h3>
<p>In this section, we further show the usage of the package by
analyzing the Early Childhood Longitudinal Study (ECLS) dataset. We use
fifth-grade cross-sectional data, focusing on students’ mathematical
assessment scores as the continuous outcome, with the continuous
predictor household income and the categorical predictor gender. Due to
the small number of observations for some schools, we fit the model
using all available observations but exclude schools with fewer than
five records when generating caterpillat plot and bar plot. This ensures
a more reliable and interpretable graphical representation of the
results.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ecls_data</span><span class="op">)</span></span>
<span><span class="va">formula_ecls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"Math_Score ~ Income + id(School_ID) + Child_Sex"</span><span class="op">)</span></span>
<span><span class="va">fit_ecls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/linear_fe.html">linear_fe</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula_ecls</span>, data <span class="op">=</span> <span class="va">ecls_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Input format: formula and data.</span></span>
<span></span>
<span><span class="va">obs_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ecls_data</span><span class="op">$</span><span class="va">School_ID</span><span class="op">)</span></span>
<span><span class="va">schools_with_5_or_more</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obs_counts</span><span class="op">[</span><span class="va">obs_counts</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Caterpillar Plot</span></span>
<span><span class="va">CI_ecls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_ecls</span>, parm <span class="op">=</span> <span class="va">schools_with_5_or_more</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/caterpillar_plot.html">caterpillar_plot</a></span><span class="op">(</span><span class="va">CI_ecls</span><span class="op">$</span><span class="va">CI.indirect</span>, use_flag <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="pprof_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bar Plot</span></span>
<span><span class="va">test_ecls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/test.html">test</a></span><span class="op">(</span><span class="va">fit_ecls</span>, parm <span class="op">=</span> <span class="va">schools_with_5_or_more</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bar_plot.html">bar_plot</a></span><span class="op">(</span><span class="va">test_ecls</span><span class="op">)</span></span></code></pre></div>
<p><img src="pprof_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Funnel Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_ecls</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="pprof_files/figure-html/unnamed-chunk-14-3.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://mcommunity.umich.edu/person/ybshao" class="external-link">Yubo Shao</a>, <a href="https://www.wenbowu.me/" class="external-link">Wenbo Wu</a>, <a href="https://www.um-kevinhe-group.org/" class="external-link">Kevin He</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
