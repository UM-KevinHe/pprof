<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Logistic Fixed Effect Model • pprof</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Logistic Fixed Effect Model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pprof</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/pprof.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix">
<li><a class="dropdown-item" href="../articles/Logis-FE.html">Logis FE</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/pprof/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Logistic Fixed Effect Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/UM-KevinHe/pprof/blob/HEAD/vignettes/Logis-FE.Rmd" class="external-link"><code>vignettes/Logis-FE.Rmd</code></a></small>
      <div class="d-none name"><code>Logis-FE.Rmd</code></div>
    </div>

    
    
<style>
body {
  text-align: justify
}
</style>
<div class="section level3">
<h3 id="estimation">Estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h3>
<p>The computational tools designed for general-purpose model fitting in
generalized linear models, such as those relying on Newton-Raphson and
Fisher scoring, fall short in meeting the computational demands as the
number of providers increases. This limitation arises due to the
substantial escalation in computational cost when incorporating
thousands of provider effects into the parameter space. Consequently,
the inversion of the Fisher information matrix becomes a computationally
burdensome task, posing a significant challenge even for workstations
specifically engineered for such purposes. To address this issue, the
SerBIN algorithm, proposed by <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/sim.9387" class="external-link">Wu et
al. (2022)</a>, leverages the block structure of the Fisher information
matrix. This innovative approach substantially reduces the time
complexity associated with inverting the high-dimensional matrix,
particularly when confronted with the presence of thousands of provider
effects.</p>
<p>Consider a binary outcome as an illustration. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
represent the total number of providers,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>i</mi></msub><annotation encoding="application/x-tex">n_i</annotation></semantics></math>
denote the number of subjects from provider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(i = 1, \dots, m)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>:=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">N := \sum_{i = 1}^m n_i</annotation></semantics></math>
signify the total number of records. For subject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>n</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(j = 1, \dots, n_i)</annotation></semantics></math>
from provider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>
be the outcome variable, and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Z_{ij}</annotation></semantics></math>
constitute the vector of risk factors. The likelihood function can then
be formulated as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo>,</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">l(\boldsymbol{\gamma}, \boldsymbol{\beta}) \propto \sum_{i = 1}^m \sum_{j = 1}^{n_i}\{Y_{ij} \cdot (\gamma_i + Z_{ij}\boldsymbol{\beta}) - log(1 + e^{\gamma_i + Z_{ij}\boldsymbol{\beta}})\},</annotation></semantics></math>
and the corresponding score function can be expressed as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup></mrow></mfrac><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">U(\gamma_i) = \sum_{j = 1}^{n_i} \{Y_{ij} - \frac{e^{\gamma_i + Z_{ij}\boldsymbol{\beta}}}{1 + e^{\gamma_i + Z_{ij}\boldsymbol{\beta}}}\}</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mi>p</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mo stretchy="false" form="prefix">{</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi><mi>p</mi></mrow></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">U(\beta_p) = \sum_{i = 1}^m \sum_{j = 1}^{n_i} \{Z_{ijp} \cdot (Y_{ij} - \frac{e^{\gamma_i + Z_{ij}\boldsymbol{\beta}}}{1 + e^{\gamma_i + Z_{ij}\boldsymbol{\beta}}})\}.</annotation></semantics></math>
In the current context, the information matrix can be visualized as a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math>
block matrix, expressed as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo>,</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo>,</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo>,</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>≡</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>I</mi><mn>22</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> I(\boldsymbol{\gamma}, \boldsymbol{\beta}) = \begin{pmatrix} I(\boldsymbol{\gamma}) &amp; I(\boldsymbol{\gamma}, \boldsymbol{\beta})   \\   I(\boldsymbol{\beta}, \boldsymbol{\gamma}) &amp; I(\boldsymbol{\beta})  \end{pmatrix} \equiv \begin{pmatrix} I_{11} &amp; I_{12} \\ I_{21} &amp; I_{22}  \end{pmatrix}.</annotation></semantics></math>
It is important to note that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I(\boldsymbol{\gamma})</annotation></semantics></math>
block is “large” but diagonal. Consequently, we can compute
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>I</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo>,</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I^{-1}(\boldsymbol{\gamma}, \boldsymbol{\beta})</annotation></semantics></math>
as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>I</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛄</mi><mo>,</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>I</mi><mn>11</mn><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mo>+</mo><msup><msub><mi>J</mi><mn>1</mn></msub><mi>T</mi></msup><msup><mi>S</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><msub><mi>J</mi><mn>1</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>−</mi><msup><msub><mi>J</mi><mn>2</mn></msub><mi>T</mi></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>−</mi><msub><mi>J</mi><mn>2</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msup><mi>S</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">I^{-1}(\boldsymbol{\gamma}, \boldsymbol{\beta}) = \begin{pmatrix} I_{11}^{-1} + {J_1}^{T} S^{-1} J_1 &amp; - {J_2}^{T}   \\   - {J_2} &amp;  S^{-1}  \end{pmatrix},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mn>1</mn></msub><mo>=</mo><msub><mi>I</mi><mn>21</mn></msub><msup><msub><mi>I</mi><mn>11</mn></msub><mrow><mi>−</mi><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">J_1 = I_{21}{I_{11}}^{-1}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><msub><mi>I</mi><mn>22</mn></msub><mo>−</mo><msub><mi>J</mi><mn>1</mn></msub><msub><mi>I</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">S = I_{22} - J_1 I_{12}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mn>2</mn></msub><mo>=</mo><msup><mi>S</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><msub><mi>J</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">J_2 = S^{-1}J_1</annotation></semantics></math>.</p>
<p>The bottleneck in SerBIN lies in computing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mn>22</mn></msub><annotation encoding="application/x-tex">I_{22}</annotation></semantics></math>
(i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I(\boldsymbol{\beta})</annotation></semantics></math>)
when the sample size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is exceptionally large. However, each element of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mn>22</mn></msub><annotation encoding="application/x-tex">I_{22}</annotation></semantics></math>
can be individually computed, allowing for parallel computing to enhance
computational efficiency:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>r</mi><mo>,</mo><mi>c</mi></mrow></msub><mo>=</mo><mo stretchy="false" form="prefix">⟨</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><msup><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>∘</mo><mi>ℙ</mi><mo stretchy="false" form="postfix">⟩</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">I(\boldsymbol{\beta})_{r,c} = \langle Z^{(r)}, Z^{(c)} \circ \mathbb{P} \rangle,</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">⟨</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false" form="postfix">⟩</mo></mrow><annotation encoding="application/x-tex">\langle a, b \rangle</annotation></semantics></math>
denotes the <a href="https://en.wikipedia.org/wiki/Inner_product_space#:~:text=In%20mathematics%2C%20an%20inner%20product,angle%20brackets%20such%20as%20in" class="external-link">inner
product</a> of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
(i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mi>T</mi></msup><mi>b</mi></mrow><annotation encoding="application/x-tex">a^T b</annotation></semantics></math>),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∘</mi><annotation encoding="application/x-tex">\circ</annotation></semantics></math>
represents the <a href="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)" class="external-link">Hadamard
product</a> (element-wise product), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℙ</mi><mo>=</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">\mathbb{P} = \frac{e^{\gamma_i + Z_{ij}\boldsymbol{\beta}}}{(1 + e^{\gamma_i + Z_{ij}\boldsymbol{\beta}})^2}</annotation></semantics></math>.
It’s worth noting that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛃</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I(\boldsymbol{\beta})</annotation></semantics></math>
is symmetric, so there’s a need to calculate only the upper triangular
entries.</p>
<p><em>(To avoid instability for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛄</mi><annotation encoding="application/x-tex">\boldsymbol{\gamma}</annotation></semantics></math>
estimation in our code, we restrict the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>𝛄</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">[</mo><mi>l</mi><mo stretchy="true" form="postfix">]</mo></mrow></msup><annotation encoding="application/x-tex">{\hat{\boldsymbol{\gamma}}}^{[l]}</annotation></semantics></math>
estimates to a specific range during each iteration. The default range
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><msub><mover><mi>𝛄</mi><mo accent="true">̂</mo></mover><mrow><mi>m</mi><mi>e</mi><mi>d</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>l</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msup><mo>±</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">{\hat{\boldsymbol{\gamma}}_{med}}^{[l-1]} \pm 10</annotation></semantics></math>.)</em></p>
<hr>
</div>
<div class="section level3">
<h3 id="standardized-ratiorate">Standardized Ratio/Rate<a class="anchor" aria-label="anchor" href="#standardized-ratiorate"></a>
</h3>
<p>In addition to the outputs for covariate coefficients and provider
effects, users can use the <code>SR_output()</code> function by
specifying the standardization method (“direct” or “indirect”) for
computing provider-level ratio/rate, where:</p>
<ul>
<li>
<strong>Indirect standardization ratio (ISR)</strong> is computed as
follows:</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>S</mi><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><mfrac><msub><mi>O</mi><mi>i</mi></msub><msub><mi>E</mi><mi>i</mi></msub></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">ISR_i = \frac{O_i}{E_i},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">O_i = \sum_{j = 1}^{n_i} Y_{ij}</annotation></semantics></math>
is the observed number of events for provider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>i</mi></msub><annotation encoding="application/x-tex">E_i</annotation></semantics></math>
is the “expected” number of events for provider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
calculated as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">E_i = \sum_{j = 1}^{n_i} \frac{e^{\gamma_0 + Z_{ij}\boldsymbol{\beta}}}{1 + e^{\gamma_0 + Z_{ij}\boldsymbol{\beta}}}</annotation></semantics></math>.
Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\gamma_0</annotation></semantics></math>
represents the “population average”, defaulting to the median value of
all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><annotation encoding="application/x-tex">\hat{\gamma}_i</annotation></semantics></math>’s.</p>
<p>In the context of indirect standardization, the interpretation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>i</mi></msub><annotation encoding="application/x-tex">E_i</annotation></semantics></math>
can be expressed as follows: “What would be the expected number of
events of provider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
if provider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
performs at the national average level?” (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4190619/" class="external-link">He and
Schaubel. (2014)</a> and <a href="https://www.sciencedirect.com/science/article/pii/S0895435607002119?via%3Dihub" class="external-link">Jones,
Ohlssen, and Sprigelhalter. (2008)</a> ). An
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>S</mi><msub><mi>R</mi><mi>i</mi></msub><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">ISR_i &gt;1</annotation></semantics></math>
indicates that provider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>’s
observed event rate is higher than expected based on the national
average.</p>
<ul>
<li>
<strong>Direct standardization ratio (DSR)</strong> is determined by
the formula:</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>D</mi><mi>S</mi><mi>R</mi></mrow><mi>k</mi></msub><mo>=</mo><mfrac><msup><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mi>O</mi></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">{DSR}_k = \frac{E^{(k)}}{O},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">O = \sum_{i = 1}^m \sum_{j = 1}^{n_i} Y_{ij}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><mfrac><msup><mi>e</mi><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">E^{(k)} = \sum_{i = 1}^m \sum_{j = 1}^{n_i} \frac{e^{\hat{\gamma}_k + Z_{ij}\boldsymbol{\beta}}}{1 + e^{\hat{\gamma}_k + Z_{ij}\boldsymbol{\beta}}}</annotation></semantics></math>.</p>
<p>In the context of direct standardization, the understanding of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">E^{(k)}</annotation></semantics></math>
can be articulated as follows: “What would be the expected number of
total events, if all providers performs as provider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>?”.</p>
<p>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>=</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">\hat{\gamma}_k = \infty</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">E^{(k)} = N</annotation></semantics></math>,
resulting in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>D</mi><mi>S</mi><mi>R</mi></mrow><mi>k</mi></msub><mo>=</mo><mfrac><mi>N</mi><mi>O</mi></mfrac></mrow><annotation encoding="application/x-tex">{DSR}_{k} = \frac{N}{O}</annotation></semantics></math>;
and if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo>=</mo><mi>−</mi><mi>∞</mi></mrow><annotation encoding="application/x-tex">\hat{\gamma}_k = -\infty</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">E^{(k)} = 0</annotation></semantics></math>,
leading to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>D</mi><mi>S</mi><mi>R</mi></mrow><mi>k</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{DSR}_{k} = 0</annotation></semantics></math>.</p>
<p>Users also have the option to request the function to generate a
“standardized rate”, which is computed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>S</mi><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">ISR_i</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>S</mi><msub><mi>R</mi><mi>k</mi></msub><mo>×</mo><mfrac><mi>O</mi><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">DSR_k \times \frac{O}{N}</annotation></semantics></math>.</p>
<p><em>(Please be aware that the computed “indirect rate” might surpass
100%. To prevent any confusion, we manually constrain the result within
the range of 0% to 100%.)</em></p>
<hr>
</div>
<div class="section level3">
<h3 id="hypothesis-testing">Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h3>
<p>The <code>test_fe()</code> function provides hypothesis testing
outcomes to assist users in identifying outlier providers with extreme
outcomes. By default, we use the median of all estimated provider
effects as the null value
(i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mrow><mi>m</mi><mi>e</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_0: \gamma_i = \hat{\gamma}_{med}</annotation></semantics></math>).
Users can choose from various testing methods, including
“exact.poisbinom” (default), “exact.bootstrap,” “score,” and “wald”:</p>
<ul>
<li><p><strong>“exact.poisbinom”</strong>: Assume
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mi>B</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>o</mi><mi>u</mi><mi>l</mi><mi>l</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_{ij}|Z_{ij} \sim Bernoulli(p_{ij})</annotation></semantics></math>.
Since within the provider
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_{ij} = \frac{e^{\gamma_i + Z_{ij}\boldsymbol{\beta}}}{1 + e^{\gamma_i + Z_{ij}\boldsymbol{\beta}}}</annotation></semantics></math>
varies,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Z</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">O_i | Z_i = \sum_{j = 1}^{n_i}Y_{ij}</annotation></semantics></math>
will follow the Poisson-binomial distribution. We then calculate the
probability of “getting a more extreme number of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>O</mi><mi>i</mi></msub><annotation encoding="application/x-tex">O_i</annotation></semantics></math>,
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0: \gamma_i = \gamma_0</annotation></semantics></math>
is true” based on the Poisson-binomial distribution.</p></li>
<li><p><strong>“exact.bootstrap”</strong>: The test is conducted in the
following steps: (1) Repeat
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">B =</annotation></semantics></math>
10,000 times (default): Simulate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>∼</mo><mi>B</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>o</mi><mi>u</mi><mi>l</mi><mi>l</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>𝛃</mi></mrow></msup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">{Y_{ij}}^{(b)} \sim Bernoulli(\frac{e^{\gamma_0 + Z_{ij}\boldsymbol{\beta}}}{1 + e^{\gamma_0 + Z_{ij}\boldsymbol{\beta}}})</annotation></semantics></math>,
and calculate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><msup><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">{Y_{i}}^{(b)} = \sum_{j = 1}^{n_i} {Y_{ij}}^{(b)}</annotation></semantics></math>.
(2) Calculate the frequency that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><msub><mi>Y</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">{Y_{i}}^{(b)}</annotation></semantics></math>
is more extreme than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>O</mi><mi>i</mi></msub><annotation encoding="application/x-tex">O_i</annotation></semantics></math>.
(3) calculate the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>−</mo></mrow><annotation encoding="application/x-tex">p-</annotation></semantics></math>value.
<em>(“Exact Bootstrap” is consistent to “Exact
Poisson-binomial”)</em></p></li>
<li><p><strong>“wald”</strong>: When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">H_0: \gamma_i = \gamma_0</annotation></semantics></math>
is true,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mi>γ</mi><mn>0</mn></msub></mrow><mrow><mi>s</mi><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{\hat{\gamma}_i - \gamma_0}{se(\hat{\gamma}_i)} \sim N(0, 1)</annotation></semantics></math>.
The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">se(\hat{\gamma}_i)</annotation></semantics></math>
can be computed using the formula mentioned earlier
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>I</mi><mn>11</mn><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mo>+</mo><msup><msub><mi>J</mi><mn>1</mn></msub><mi>T</mi></msup><msup><mi>S</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><msub><mi>J</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">I_{11}^{-1} + {J_1}^{T} S^{-1} J_1</annotation></semantics></math>)
but with only diagonal elements. <em>(The “Wald test” is not valid for
outlying providers
(i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>=</mo><mi>±</mi><mi>∞</mi></mrow><annotation encoding="application/x-tex">\hat{\gamma}_i = \pm \infty</annotation></semantics></math>).
“Error message” is added in the code to inform users.)</em></p></li>
<li><p><strong>“score”</strong>: In the standard score test procedure,
the first step involves computing the “restricted MLE” of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\hat{\boldsymbol{\beta}}^{(i)}</annotation></semantics></math>.
Subsequently, calculate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mn>0</mn></msub></mrow></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><mo stretchy="false" form="prefix">{</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow></msup></mrow></mfrac><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">U(\gamma_i)|_{\gamma_i = \gamma_0} = \sum_{j = 1}^{n_i} \{Y_{ij} - \frac{e^{\gamma_0 + Z_{ij}\hat{\boldsymbol{\beta}}^{(i)}}}{1 + e^{\gamma_0 + Z_{ij}\hat{\boldsymbol{\beta}}^{(i)}}}\}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mn>0</mn></msub></mrow></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><mo stretchy="false" form="prefix">{</mo><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msup><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">I(\gamma_i)|_{\gamma_i = \gamma_0} = \sum_{j = 1}^{n_i} \{\frac{e^{\gamma_0 + Z_{ij}\hat{\boldsymbol{\beta}}^{(i)}}}{(1 + e^{\gamma_0 + Z_{ij}\hat{\boldsymbol{\beta}}^{(i)}})^2}\}</annotation></semantics></math>.
Under
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mn>0</mn></msub></mrow></msub></mrow><msqrt><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mn>0</mn></msub></mrow></msub></mrow></msqrt></mfrac><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{U(\gamma_i)|_{\gamma_i = \gamma_0}}{\sqrt{I(\gamma_i)|_{\gamma_i = \gamma_0}}} \sim N(0, 1)</annotation></semantics></math>.
However, given the potentially high dimensionality of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>,
re-fitting the new restricted model for each provider effect test could
be challenging. Therefore, instead of using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\hat{\boldsymbol{\beta}}^{(i)}</annotation></semantics></math>,
we solely employ the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\beta}}</annotation></semantics></math>
estimated by the full model.</p></li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="confidence-interval">Confidence Interval<a class="anchor" aria-label="anchor" href="#confidence-interval"></a>
</h3>
<p>The choices for calculating confidence intervals of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_i</annotation></semantics></math>
include the following methods:</p>
<ul>
<li><p><strong>“exact”</strong>: Based on the Poisson binomial
distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Z</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">O_i|Z_i</annotation></semantics></math>.
We numerically find the range of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\gamma_0</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>e</mi><mi>x</mi><mi>a</mi><mi>c</mi><mi>t</mi></mrow></msub><mo>≥</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">P_{exact} \geq 0.05</annotation></semantics></math>,
which involves locating the roots of an equation.</p></li>
<li><p><strong>“wald”</strong>: Directly convert
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>±</mo><mn>1.96</mn><mo>×</mo><mi>s</mi><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\gamma}_i \pm 1.96 \times se(\hat{\gamma}_i)</annotation></semantics></math>,
which is invalid for outlying providers.</p></li>
<li><p><strong>“score”</strong>: Find the range of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\gamma_0</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mn>0</mn></msub></mrow></msub></mrow><msqrt><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mo stretchy="false" form="prefix">|</mo><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>γ</mi><mn>0</mn></msub></mrow></msub></mrow></msqrt></mfrac><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mn>1.96</mn><mo>,</mo><mn>1.96</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{U(\gamma_i)|_{\gamma_i = \gamma_0}}{\sqrt{I(\gamma_i)|_{\gamma_i = \gamma_0}}} \in (-1.96, 1.96)</annotation></semantics></math>.</p></li>
</ul>
<p>We can also derive the confidence interval for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>S</mi><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">ISR_i</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>S</mi><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">DSR_i</annotation></semantics></math>
based on the confidence interval for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_i</annotation></semantics></math>.</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>S</mi><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">ISR_i</annotation></semantics></math>:
Given that the score equation provides
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>i</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><mfrac><msup><mi>e</mi><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mover><mi>γ</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">O_i = \sum_{j = 1}^{n_i} \frac{e^{\hat{\gamma}_i + Z_{ij}\hat{\boldsymbol{\beta}}}}{1 + e^{\hat{\gamma}_i + Z_{ij}\hat{\boldsymbol{\beta}}}}</annotation></semantics></math>,
the CI of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>S</mi><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">ISR_i</annotation></semantics></math>
can be calculated as:</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>I</mi><mrow><mi>I</mi><mi>S</mi><msub><mi>R</mi><mi>i</mi></msub></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mrow><mi>i</mi><mo>,</mo><mi>L</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mrow><mi>i</mi><mo>,</mo><mi>L</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup></mrow></mfrac></mrow><msub><mi>E</mi><mi>i</mi></msub></mfrac><mo>,</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mrow><mi>i</mi><mo>,</mo><mi>U</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mrow><mi>i</mi><mo>,</mo><mi>U</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup></mrow></mfrac></mrow><msub><mi>E</mi><mi>i</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">CI_{ISR_i} = (\frac{\sum_{j = 1}^{n_i} \frac{e^{\gamma_{i,L} + Z_{ij}\hat{\boldsymbol{\beta}}}}{1 + e^{\gamma_{i,L} + Z_{ij}\hat{\boldsymbol{\beta}}}}}{E_i}, \frac{\sum_{j = 1}^{n_i} \frac{e^{\gamma_{i,U} + Z_{ij}\hat{\boldsymbol{\beta}}}}{1 + e^{\gamma_{i,U} + Z_{ij}\hat{\boldsymbol{\beta}}}}}{E_i}).</annotation></semantics></math>
Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mrow><mi>i</mi><mo>,</mo><mi>L</mi></mrow></msub><annotation encoding="application/x-tex">\gamma_{i,L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mrow><mi>i</mi><mo>,</mo><mi>U</mi></mrow></msub><annotation encoding="application/x-tex">\gamma_{i,U}</annotation></semantics></math>
are the lower and upper bounds of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\gamma_i</annotation></semantics></math>.
<em>(If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">CI(\gamma_i)</annotation></semantics></math>
covers
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\gamma_0</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>I</mi><mrow><mi>I</mi><mi>S</mi><msub><mi>R</mi><mi>i</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">CI_{ISR_i}</annotation></semantics></math>
will cover 1.)</em></p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>S</mi><msub><mi>R</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">DSR_k</annotation></semantics></math>:
Considering
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>S</mi><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><mfrac><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup></mrow></mfrac></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>O</mi><mi>i</mi></msub></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">DSR_{0} = \frac{\sum_{i = 1}^m \sum_{j = 1}^{n_i} \frac{e^{{\gamma}_0 + Z_{ij}\hat{\boldsymbol{\beta}}}}{1 + e^{{\gamma}_0 + Z_{ij}\hat{\boldsymbol{\beta}}}}}{\sum_{i = 1}^m O_i}.</annotation></semantics></math>
The CI of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>S</mi><msub><mi>R</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">DSR_k</annotation></semantics></math>
can be calculated as:</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>I</mi><mrow><mi>D</mi><mi>S</mi><msub><mi>R</mi><mi>k</mi></msub></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mrow><mi>k</mi><mo>,</mo><mi>L</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mrow><mi>k</mi><mo>,</mo><mi>L</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup></mrow></mfrac></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>O</mi><mi>i</mi></msub></mrow></mfrac><mo>,</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></munderover><mfrac><msup><mi>e</mi><mrow><msub><mi>γ</mi><mrow><mi>k</mi><mo>,</mo><mi>U</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><msub><mi>γ</mi><mrow><mi>k</mi><mo>,</mo><mi>U</mi></mrow></msub><mo>+</mo><msub><mi>Z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow></msup></mrow></mfrac></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>O</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">CI_{DSR_k} = (\frac{\sum_{i = 1}^m \sum_{j = 1}^{n_i} \frac{e^{{\gamma}_{k,L} + Z_{ij}\hat{\boldsymbol{\beta}}}}{1 + e^{{\gamma}_{k,L} + Z_{ij}\hat{\boldsymbol{\beta}}}}}{\sum_{i = 1}^m O_i}, \frac{\sum_{i = 1}^m \sum_{j = 1}^{n_i} \frac{e^{{\gamma}_{k,U} + Z_{ij}\hat{\boldsymbol{\beta}}}}{1 + e^{{\gamma}_{k,U} + Z_{ij}\hat{\boldsymbol{\beta}}}}}{\sum_{i = 1}^m O_i}).</annotation></semantics></math>
Similarly,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mrow><mi>k</mi><mo>,</mo><mi>L</mi></mrow></msub><annotation encoding="application/x-tex">\gamma_{k,L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mrow><mi>k</mi><mo>,</mo><mi>U</mi></mrow></msub><annotation encoding="application/x-tex">\gamma_{k,U}</annotation></semantics></math>
are the lower and upper bounds of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\gamma_k</annotation></semantics></math>.
<em>(If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">CI(\gamma_k)</annotation></semantics></math>
covers
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>γ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\gamma_0</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msub><mi>I</mi><mrow><mi>D</mi><mi>S</mi><msub><mi>R</mi><mi>k</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">CI_{DSR_k}</annotation></semantics></math>
will cover
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>S</mi><msub><mi>R</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">DSR_k</annotation></semantics></math>.)</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xiaohan Liu, Lingfeng Luo, Yubo Shao, Xiangeng Fang, Wenbo Wu, Kevin He.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
