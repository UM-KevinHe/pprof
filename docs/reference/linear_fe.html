<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit a fixed effect linear model via profile likelihood or dummy encoding."><title>Main function for fitting the fixed effect linear model — linear_fe • pprof</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Main function for fitting the fixed effect linear model — linear_fe"><meta property="og:description" content="Fit a fixed effect linear model via profile likelihood or dummy encoding."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pprof</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/pprof.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-appendix">Appendix</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-appendix">
    <a class="dropdown-item" href="../articles/Logis-FE.html">Logis FE</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/UM-KevinHe/pprof/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Main function for fitting the fixed effect linear model</h1>
      <small class="dont-index">Source: <a href="https://github.com/UM-KevinHe/pprof/blob/HEAD/R/linear_fe.R" class="external-link"><code>R/linear_fe.R</code></a></small>
      <div class="d-none name"><code>linear_fe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a fixed effect linear model via profile likelihood or dummy encoding.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">linear_fe</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Z <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ID <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Y.char <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Z.char <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ID.char <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"pl"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>a two-sided formula object describing the model to be fitted,
with the response variable on the left of a ~ operator and covariates on the right,
separated by + operators. The fixed effect of the provider identifier is specified using <code>id()</code>.</p></dd>


<dt>data</dt>
<dd><p>a data frame containing the variables named in the <code>formula</code>,
or the columns specified by <code>Y.char</code>, <code>Z.char</code>, and <code>ID.char</code>.</p></dd>


<dt>Y</dt>
<dd><p>a numeric vector representing the response variable.</p></dd>


<dt>Z</dt>
<dd><p>a matrix or data frame representing the covariates, which can include both numeric and categorical variables.</p></dd>


<dt>ID</dt>
<dd><p>a numeric vector representing the provider identifier.</p></dd>


<dt>Y.char</dt>
<dd><p>a character string specifying the column name of the response variable in the <code>data</code>.</p></dd>


<dt>Z.char</dt>
<dd><p>a character vector specifying the column names of the covariates in the <code>data</code>.</p></dd>


<dt>ID.char</dt>
<dd><p>a character string specifying the column name of the provider identifier in the <code>data</code>.</p></dd>


<dt>method</dt>
<dd><p>a character string specifying the method to fit the model.</p><ul><li><p><code>"pl"</code> (default) uses profile likelihood to fit the model.</p></li>
<li><p><code>"dummy"</code> calls <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> to fit the model using dummy variables for the provider identifier.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of objects with S3 class <code>"linear_fe"</code>:</p>
<dl><dt>coefficient</dt>
<dd><p>a list containing the estimated coefficients:
<code>beta</code>, the fixed effects for each predictor, and <code>gamma</code>, the effect for each provider.</p></dd>

<dt>variance</dt>
<dd><p>a list containing the variance estimates:
<code>beta</code>, the variance-covariance matrix of the predictor coefficients, and <code>gamma</code>, the variance of the provider effects.</p></dd>

<dt>sigma</dt>
<dd><p>the residual standard error.</p></dd>

<dt>fitted</dt>
<dd><p>the fitted values of each individual.</p></dd>

<dt>observation</dt>
<dd><p>the original response of each individual.</p></dd>

<dt>residuals</dt>
<dd><p>the residuals of each individual, that is response minus fitted values.</p></dd>

<dt>linear_pred</dt>
<dd><p>the linear predictor of each individual.</p></dd>

<dt>data_include</dt>
<dd><p>the data used to fit the model, sorted by the provider identifier.
For categorical covariates, this includes the dummy variables created for
all categories except the reference level.</p></dd>

<dt>char_list</dt>
<dd><p>a list of the character vectors representing the column names for
the response variable, covariates, and provider identifier.
For categorical variables, the names reflect the dummy variables created for each category.</p></dd>

<dt>method</dt>
<dd><p>the method used for model fitting, either <code>"Profile Likelihood"</code> or <code>"Dummy"</code>.</p></dd>

<dt>Loglkd</dt>
<dd><p>log likelihood.</p></dd>

<dt>AIC</dt>
<dd><p>Akaike information criterion.</p></dd>

<dt>BIC</dt>
<dd><p>Bayesian information criterion.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is used to fit a fixed effect linear model of the form:
$$Y_{ij} = \gamma_i + \mathbf{Z}_{ij}^\top\boldsymbol\beta + \epsilon_{ij}$$
where \(Y_{ij}\) is the continuous outcome for individual \(j\) in provider \(i\), \(\gamma_i\) is the provider-specific effect, \(\mathbf{Z}_{ij}\) are the covariates, and \(\boldsymbol\beta\) is the vector of coefficients for the covariates.
The default method for fitting the model is profile likelihood, but dummy encoding can also be used by specifying the appropriate method.
When the number of providers is very large, we recommend using the profile likelihood method, as it is computationally efficient and requires
less memory usage.</p>
<p>The function accepts three different input formats:
a formula and dataset, where the formula is of the form <code>response ~ covariates + id(provider)</code>, with <code>provider</code> representing the provider identifier;
a dataset along with the column names of the response, covariates, and provider identifier;
or the outcome vector \(\boldsymbol{Y}\), the covariate matrix or data frame \(\mathbf{Z}\), and the provider identifier vector.</p>
<p>If issues arise during model fitting, consider using the <code>data_check</code> function to perform a data quality check,
which can help identify missing values, low variation in covariates, high-pairwise correlation, and multicollinearity.
For datasets with missing values, this function automatically removes observations (rows) with any missing values before fitting the model.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hsiao, C. (2022). Analysis of panel data (No. 64). Cambridge university press.
<br></p>
<p>R Core Team (2023). <em>The R Stats Package: lm</em>.
Available at: <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html" class="external-link">https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html</a>
<br></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="data_check.html">data_check</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleDataLinear</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="va">ExampleDataLinear</span><span class="op">$</span><span class="va">Y</span></span></span>
<span class="r-in"><span><span class="va">covar</span> <span class="op">&lt;-</span> <span class="va">ExampleDataLinear</span><span class="op">$</span><span class="va">Z</span></span></span>
<span class="r-in"><span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="va">ExampleDataLinear</span><span class="op">$</span><span class="va">ID</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">outcome</span>, <span class="va">ID</span>, <span class="va">covar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">covar.char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">covar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome.char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">ID.char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"outcome ~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">covar.char</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span>, <span class="st">"+ id(ID)"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit fixed linear effect model using three input formats</span></span></span>
<span class="r-in"><span><span class="va">fit_fe1</span> <span class="op">&lt;-</span> <span class="fu">linear_fe</span><span class="op">(</span>Y <span class="op">=</span> <span class="va">outcome</span>, Z <span class="op">=</span> <span class="va">covar</span>, ID <span class="op">=</span> <span class="va">ID</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input format: Y, Z, and ID.</span>
<span class="r-in"><span><span class="va">fit_fe2</span> <span class="op">&lt;-</span> <span class="fu">linear_fe</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, Y.char <span class="op">=</span> <span class="va">outcome.char</span>, Z.char <span class="op">=</span> <span class="va">covar.char</span>, ID.char <span class="op">=</span> <span class="va">ID.char</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input format: data, Y.char, Z.char, and ID.char.</span>
<span class="r-in"><span><span class="va">fit_fe3</span> <span class="op">&lt;-</span> <span class="fu">linear_fe</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input format: formula and data.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Xiaohan Liu, Lingfeng Luo, Yubo Shao, Xiangeng Fang, Wenbo Wu, Kevin He.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

