<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Conduct hypothesis testing for provider effects from a fitted logis_fe object — test.logis_fe • pprof</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conduct hypothesis testing for provider effects from a fitted logis_fe object — test.logis_fe"><meta name="description" content="Conduct hypothesis tests on provider effects and identify outlying providers for a fixed effect logistic model."><meta property="og:description" content="Conduct hypothesis tests on provider effects and identify outlying providers for a fixed effect logistic model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pprof</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pprof.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-appendix" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Appendix</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-appendix"><li><a class="dropdown-item" href="../articles/Logis-FE.html">Logis FE</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UM-KevinHe/pprof/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Conduct hypothesis testing for provider effects from a fitted <code>logis_fe</code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/UM-KevinHe/pprof/blob/HEAD/R/test.logis_fe.R" class="external-link"><code>R/test.logis_fe.R</code></a></small>
      <div class="d-none name"><code>test.logis_fe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Conduct hypothesis tests on provider effects and identify outlying providers for a fixed effect logistic model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'logis_fe'</span></span>
<span><span class="fu"><a href="test.html">test</a></span><span class="op">(</span></span>
<span>  <span class="va">fit</span>,</span>
<span>  <span class="va">parm</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  test <span class="op">=</span> <span class="st">"exact.poisbinom"</span>,</span>
<span>  score_modified <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  null <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>a model fitted from <code>logis_fe</code>.</p></dd>


<dt id="arg-parm">parm<a class="anchor" aria-label="anchor" href="#arg-parm"></a></dt>
<dd><p>specifies a subset of providers for which confidence intervals are to be given.
By default, all providers are included. The class of <code>parm</code> should match the class of the provider IDs.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>the confidence level during the hypothesis test, meaning a significance level of \(1 - \text{level}\).
The default value is 0.95.</p></dd>


<dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>a character string specifying the type of testing method to be conducted. The default is "exact.poisbinom".</p><ul><li><p><code>"exact.poisbinom"</code>: exact test based on Poisson-binomial distribution of \(O_i|Z_i\).</p></li>
<li><p><code>"exact.bootstrap"</code>: exact test based on bootstrap procedure.</p></li>
<li><p><code>"wald"</code>: wald test.</p></li>
<li><p><code>"score"</code>: score test.</p></li>
</ul></dd>


<dt id="arg-score-modified">score_modified<a class="anchor" aria-label="anchor" href="#arg-score-modified"></a></dt>
<dd><p>a logical indicating whether to use the modified score test
ignoring the randomness of covariate coefficient for score teat (<code>"test = score"</code>). The default value is TRUE.</p></dd>


<dt id="arg-null">null<a class="anchor" aria-label="anchor" href="#arg-null"></a></dt>
<dd><p>a character string or a number specifying null hypotheses of fixed provider effects. The default is <code>"median"</code>.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>resample size for bootstrapping when (<code>"test = exact.bootstrap"</code>). The default value is 10,000.</p></dd>


<dt id="arg-threads">threads<a class="anchor" aria-label="anchor" href="#arg-threads"></a></dt>
<dd><p>an integer specifying the number of threads to use. The default value is 1.</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>a character string specifying the alternative hypothesis, must be one of
<code>"two.sided"</code> (default), <code>"greater"</code>, or <code>"less"</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments that can be passed to the function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing the results of the hypothesis test, with the following columns:</p>
<dl><dt>flag</dt>
<dd><p>a flagging indicator where <code>1</code> means statistically higher than expected
and <code>-1</code> means statistically lower than expected.</p></dd>

<dt>p-value</dt>
<dd><p>the p-value of the hypothesis test.</p></dd>

<dt>stat</dt>
<dd><p>the test statistic.</p></dd>

<dt>Std.Error</dt>
<dd><p>The standard error of the provider effect estimate, included only when <code>test = "wald"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>By default, the function uses the <code>"exact.poisbinom"</code> method.
The wald test is invalid for extreme providers (i.e. when provider effect goes to infinity).
For the score test, consider that when the number of tested providers is large,
refitting the models to get the restricted MLEs will take a long time.
Therefore, we use unrestricted MLEs to replace the restricted MLEs during the testing procedure by default.
However, the user can specify <code>score_modified = FALSE</code> to perform a standard score test.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wu, W, Yang, Y, Kang, J, He, K. (2022) Improving large-scale estimation and inference for profiling health care providers.
<em>Statistics in Medicine</em>, <strong>41(15)</strong>: 2840-2853.
<br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ExampleDataBinary</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome</span> <span class="op">=</span> <span class="va">ExampleDataBinary</span><span class="op">$</span><span class="va">Y</span></span></span>
<span class="r-in"><span><span class="va">covar</span> <span class="op">=</span> <span class="va">ExampleDataBinary</span><span class="op">$</span><span class="va">Z</span></span></span>
<span class="r-in"><span><span class="va">ProvID</span> <span class="op">=</span> <span class="va">ExampleDataBinary</span><span class="op">$</span><span class="va">ProvID</span></span></span>
<span class="r-in"><span><span class="va">fit_fe</span> <span class="op">&lt;-</span> <span class="fu"><a href="logis_fe.html">logis_fe</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">outcome</span>, Z <span class="op">=</span> <span class="va">covar</span>, ProvID <span class="op">=</span> <span class="va">ProvID</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="test.html">test</a></span><span class="op">(</span><span class="va">fit_fe</span>, test <span class="op">=</span> <span class="st">"score"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     flag      p value        stat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0 2.368547e-01 -1.18288504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      0 5.275655e-01  0.63172674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      0 2.407223e-01 -1.17318325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      0 4.103448e-01  0.82328704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      0 8.518166e-01 -0.18680109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      0 7.340842e-01  0.33969768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      0 8.678381e-01  0.16640513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      0 8.234055e-01 -0.22316704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     -1 1.175431e-03 -3.24477586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     1 8.789591e-03  2.62013132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     0 9.760882e-02  1.65655822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     0 8.217279e-01  0.22532311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     0 2.693589e-01  1.10454014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     0 1.351957e-01 -1.49392322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     0 8.366228e-01  0.20621522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    -1 3.074323e-02 -2.16038050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     0 6.828884e-02  1.82309611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    -1 3.505997e-02 -2.10766509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     0 5.591967e-01  0.58403508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     0 9.898703e-01  0.01269602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     0 6.651296e-02  1.83495095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22     1 2.501334e-04  3.66212330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     0 7.014939e-01  0.38330466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     0 9.362285e-02 -1.67658915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25     0 6.129192e-02 -1.87138369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26     0 9.866786e-01 -0.01669667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27     0 3.722253e-01  0.89231272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28     0 4.530424e-01 -0.75035249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29     0 5.111253e-01  0.65708654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30     1 4.913776e-02  1.96739439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31     0 6.844535e-01  0.40639348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32     0 4.298946e-01 -0.78937208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33     0 5.470421e-01 -0.60219837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34     0 5.637157e-01 -0.57733124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35     0 1.028324e-01  1.63127460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36     0 7.631298e-02  1.77249162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37     0 1.763862e-01 -1.35196586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38     0 6.671747e-02 -1.83357257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39     0 3.840996e-01 -0.87036748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40    -1 3.642754e-04 -3.56469798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41    -1 3.438016e-03 -2.92559189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42     0 8.481478e-01  0.19148218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43     0 1.386651e-01  1.48078024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44     0 1.023298e-01 -1.63366235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45     1 4.032529e-02  2.05040122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46     0 9.503849e-02 -1.66939820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47     0 3.003560e-01  1.03567016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48    -1 2.077418e-02 -2.31206350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49    -1 9.985059e-03 -2.57634628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50    -1 2.191895e-04 -3.69580693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51     0 7.801087e-02 -1.76234592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52     0 2.975269e-01 -1.04175157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53     0 6.478207e-01  0.45679184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54     0 8.422148e-01  0.19906131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55     0 1.239934e-01 -1.53822567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56     0 3.609434e-01  0.91356884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57     0 3.786168e-01  0.88044773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58     0 2.121593e-01 -1.24764986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59     0 7.466727e-01  0.32302978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60     0 4.544028e-01 -0.74809513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61     1 5.356552e-04  3.46226211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62     0 6.611430e-02  1.83764793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63     0 3.474364e-01  0.93957353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64     0 3.852536e-01  0.86825714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65     0 9.967024e-02 -1.64645442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66     0 9.901912e-01 -0.01229387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67     0 2.857652e-01 -1.06745767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68     0 8.733720e-01  0.15937680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69     0 3.132875e-01 -1.00834791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70     0 2.083547e-01 -1.25810237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71     0 5.543279e-01 -0.59128739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72    -1 1.522301e-03 -3.17039826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73     0 8.844973e-02 -1.70363269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74    -1 1.448525e-02 -2.44499902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75     1 4.095939e-03  2.87067690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76     0 3.707370e-01  0.89509379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77     0 9.217127e-02 -1.68405380</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78     0 3.036570e-01  1.02862272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79     0 8.790315e-01 -0.15219705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80    -1 5.365323e-03 -2.78424050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81     0 1.431811e-01 -1.46404714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82     0 4.143958e-01  0.81618239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83     0 1.775808e-01  1.34824130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84     0 1.390201e-01  1.47944991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85     0 8.999547e-02  1.69542161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86    -1 3.262394e-02 -2.13668106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87     0 5.039333e-01 -0.66831374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88     0 3.066655e-01  1.02224379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89     0 2.873969e-01 -1.06384938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90     0 2.530347e-01  1.14300926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91     0 3.377431e-01  0.95863405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92     0 9.162883e-01  0.10511032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93     0 1.202064e-01 -1.55390796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94    -1 6.235120e-03 -2.73515348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95     0 1.165077e-01  1.56960197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96     1 8.359125e-06  4.45577351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97     0 2.953818e-01  1.04638830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98     0 4.866249e-01 -0.69568697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99     0 6.223881e-01 -0.49246856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100    0 2.861710e-01  1.06655902</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xiaohan Liu, Lingfeng Luo, Yubo Shao, Xiangeng Fang, Wenbo Wu, Kevin He.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

